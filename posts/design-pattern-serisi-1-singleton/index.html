<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		 
			
  
    <meta name="twitter:card" content="summary"/>
    
      <meta name="twitter:image" content="www.alimozdemir.comimages/avatar.png" />
    
  
  
  <meta name="twitter:title" content="Design Pattern Serisi 1: Singleton"/>
  <meta name="twitter:description" content="Herkese merhaba, öncelikle neden başlıkta ingilizce terimler kullandığıma değinmek istiyorum. Yazılım dünyasında ağırlıklı dilin ingilizce…"/>
  
    <meta name="twitter:site" content="@almozdmr"/>
  
  
  
  
    <meta name="twitter:creator" content="@Alim Özdemir"/>
  



		
		<meta name="author" content="Alim Özdemir">
		<meta name="keywords" content="dotnet,design patterns,tasarim kalibi,singleton">
		<meta name="description" content="Site Description">
		<meta name="generator" content="Hugo 0.72.0" />
		<title>Design Pattern Serisi 1: Singleton &middot; Alim Özdemir</title>
		<link rel="shortcut icon" href="www.alimozdemir.comimages/favicon.ico">
		<link rel="stylesheet" href="www.alimozdemir.comcss/style.css">
		<link rel="stylesheet" href="www.alimozdemir.comcss/highlight.css">

		
		<link rel="stylesheet" href="www.alimozdemir.comcss/font-awesome.min.css">
		

		
		<link href="www.alimozdemir.com/index.xml" rel="alternate" type="application/rss+xml" title="Alim Özdemir" />
		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='www.alimozdemir.com'> <span class="arrow">←</span> Home</a>
	
	<a href='www.alimozdemir.composts'>Archive</a>
	<a href='www.alimozdemir.comprojects'>Projects</a>
	<a href='www.alimozdemir.comtags'>Tags</a>
	<a href='www.alimozdemir.comabout'>About</a>

	

	
	<a class="cta" href="www.alimozdemir.com/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        Design Pattern Serisi 1: Singleton
                    </h1>
                    <h2 class="headline">
                    Sep 3, 2018 06:56
                    · 658 words
                    · 4 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="www.alimozdemir.comtags/dotnet">dotnet</a>
                          
                              <a href="www.alimozdemir.comtags/design-patterns">design patterns</a>
                          
                              <a href="www.alimozdemir.comtags/tasarim-kalibi">tasarim kalibi</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    <p>Herkese merhaba, öncelikle neden başlıkta ingilizce terimler kullandığıma değinmek istiyorum. Yazılım dünyasında ağırlıklı dilin ingilizce olduğu ve bu tür terimlerin türkçe karşılığı bana çok anlamlı gelmediği için bu şekilde başlık atma gereği duydum. Design Pattern için Tasarım Deseni çevirisi yapılabilir. Belki TDK buna farklı bir isim verirse daha güzel olabilir ancak ben yine de bu tür ünlü terimleri ingilizce bırakarak makale serime devam etmek istiyorum.</p>
<p>Makale serimi C# üzerinde uygulayacağım. Ve .NET Core platformu üzerinden göstereceğim. Burada gerçekleştirilmiş tüm kodlara bu linkten <a href="https://github.com/lyzerk/medium/tree/master/DesignPatternSingleton">Github</a> ulaşabilirsiniz.</p>
<h3 id="singleton-pattern">Singleton Pattern</h3>
<p><img src="/img/1__b1Z3NB5cxQL5preMW4nCiw.png" alt="Singleton Pattern Class Diagram">
Singleton Pattern Class Diagram</p>
<p>Bu design pattern en basit olanlarından biridir. Varsayalımki projenizde öyle bir sınıfa ihtiyaç var ki sadece sizin tarafınızda oluşturulup tek bir noktadan kullanılmasını istiyorsunuz. Bu durumda bu design pattern devreye giriyor ve küçük nüanslarla bizi büyük dertlerden kurtarabiliyor. Elde etmek istediğimiz yapı sol taraftaki Class Diagram’ında gösterilmektedir. Öncelikle ilk aşamadan başlayarak örnek sınıfımızı oluşturup gösterelim. Daha sonra bu sınıfı adım adım nasıl Singleton Pattern yapacağımızı görelim.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ActionHistory_V1</span> : IActionHistory
{
    <span style="color:#66d9ef">private</span> Stack&lt;<span style="color:#66d9ef">string</span>&gt; _history { <span style="color:#66d9ef">get</span>; <span style="color:#66d9ef">set</span>; }

    <span style="color:#66d9ef">public</span> ActionHistory_V1()
    {
        <span style="color:#66d9ef">if</span> (File.Exists(<span style="color:#e6db74">&#34;actions.txt&#34;</span>))
        {
            <span style="color:#66d9ef">var</span> lines = File.ReadAllLines(<span style="color:#e6db74">&#34;actions.txt&#34;</span>);

            _history = <span style="color:#66d9ef">new</span> Stack&lt;<span style="color:#66d9ef">string</span>&gt;(lines.ToList());
        }
        <span style="color:#66d9ef">else</span>
            _history = <span style="color:#66d9ef">new</span> Stack&lt;<span style="color:#66d9ef">string</span>&gt;();
    }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> AddAction(<span style="color:#66d9ef">string</span> action)
    {
        _history.Push(action);
    }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Save()
    {
        File.WriteAllLines(<span style="color:#e6db74">&#34;actions.txt&#34;</span>, _history);
    }
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">string</span> RetriveLastAction()
    {
        <span style="color:#66d9ef">return</span> _history.FirstOrDefault();
    }
    <span style="color:#66d9ef">public</span> List&lt;<span style="color:#66d9ef">string</span>&gt; RetriveAllActions()
    {
        <span style="color:#66d9ef">return</span> _history.ToList();
    }
}
</code></pre></div><p>Uygulamanın ilk versiyonu</p>
<p>Aksiyon geçmişini hafızada tutan ve gerektiği zaman kaydedebilen bir sınıf oluşturdum. Böyle bir sınıfın bir projede tek bir elden kullanılması doğru bir yaklaşım sağlayacaktır. Yukarıdaki hali ile kullanmak istersek sadece yeni bir instance açmamız bize kullanımını sağlayacaktır. Ancak, bu sınıf birden fazla oluşturulursa her bir instance kendine ait <code>Stack&lt;string&gt;</code> tutacaktır ve ona göre dosyaya kaydetme işlemi yapacaktır ancak biz bunu istemiyoruz.</p>
<p>Öncelikle, Singleton Pattern’ın en can alıcı kısmı constructor kısmının erişebilirlik düzeyini <code>public</code> den <code>private</code> yapmamız gerekmekte. Bu sayede bu sınıfı kendi içi dışında hiç bir yerde oluşturamayacağız. Oluşturmaya çalıştığımızda da bu hata ile karşılaşacağız.</p>
<blockquote>
<p>ActionHistory_V1.ActionHistory_V1()’ is inaccessible due to its protection level</p>
</blockquote>
<p>Bu yaklaşım ile bu sınıfı sadece tek bir yerde yani kendi içinde oluşturabileceğiz. Sınıfı bu şekilde düzenleyebiliriz.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ActionHistory_V2</span> : IActionHistory
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> ActionHistory_V2 instance = <span style="color:#66d9ef">new</span> ActionHistory_V2();
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> ActionHistory_V2 Instance { <span style="color:#66d9ef">get</span>; } = instance;

    <span style="color:#66d9ef">private</span> ActionHistory_V2()
    {
        ....
    }
    
    ....
}
</code></pre></div><p>Uygulamanın ikinci versiyonu</p>
<p>Bu şekilde projede aşağıdaki şekilde kullanımı sağlanacaktır. Sınıf içerisinde buluna Instance özelliğine erişerek sınıfı elde etmemiz yetecektir. Daha sonrasında sınıfı istediğimiz şekilde kullanmamız için hazır.</p>
<p>IActionHistory history = ActionHistory_V2.Instance;<br>
history.AddAction(“delete”);<br>
var lastAction = history.RetrieveLastAction();</p>
<p>Ancak burada da bir sorun ile karşılaşıyoruz, o da bu oluşturduğumuz sınıf daha ağır yüklü bi sınıf olabilir o yüzden programın başlangıcında oluşturulması (static olarak tanımladığımız ve oluşturduğumuz için program açıldığında sınıfı oluşturacaktır.), programın açılış süresini etkileyebilir. Bunun için <code>Instance</code> özelliği (property) ilk istenildiğinde oluşturulması akılcı bir çözüm olabilir. Daha bitmedi ! burada aynı anda birden fazla erişim yapılırsa instance birden fazla oluşturulabilir, o yüzden bu kısmın <code>Critical Section</code>olarak dikkate alınması gerekmektedir. Bu yüzden o kod bloğunu <code>lock</code> keywordu ile kilitleyip <code>thread-safe</code> yapabiliriz. Ancak ben sizi bunlarla uğraştırmayacağım.</p>
<p>.NET de bulunan <code>Lazy&lt;T&gt;</code> yapısını kullanarak, bu objenin hem istenildiği zamanda hem de <code>thread-safe</code> olarak oluşturulmasını sağlayacağız.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ActionHistory_V3</span> : IActionHistory
{
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Lazy&lt;ActionHistory_V3&gt; instance =
                    <span style="color:#66d9ef">new</span> Lazy&lt;ActionHistory_V3&gt;(() =&gt; <span style="color:#66d9ef">new</span> ActionHistory_V3());
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> ActionHistory_V3 Instance { <span style="color:#66d9ef">get</span>; } = instance.Value;

    <span style="color:#66d9ef">private</span> ActionHistory_V3()
    {
        ....
    }
    
    ....
}
</code></pre></div><p>Uygulamanın son versiyonu</p>
<p>Bu çözüm ile birlikte ilk kullanım sırasında, gerektiğinde sınıfı oluşturacak ve programın açılış hızında yavaşlama sağlamayacaktır. Yine de bu yaklaşımda her sınıfa göre değişebilir. Siz kendi sınıfınızın amacına ve özelliklerine göre ayrı bir şekilde tasarım yapmanız gerekebilir. Bu yüzden bu tür yaklaşımlarda kurallara uymak yerine kuralları esneterek kendinize göre bir çözüm üretmeniz gerekecektir.</p>
<p>Yukarıdaki kodların tamamlanmış haline <a href="https://github.com/lyzerk/medium/tree/master/DesignPatternSingleton">buradan</a> erişebilirsiniz. Bir sonraki yazıda görüşmek üzere.</p>
<h4 id="kaynaklar">Kaynaklar</h4>
<p><a href="https://www.tutorialspoint.com/design_pattern/singleton_pattern.htm" title="https://www.tutorialspoint.com/design_pattern/singleton_pattern.htm"><strong>Design Patterns Singleton Pattern</strong><br>
_Design Patterns Singleton Pattern - Learning java design patterns in simple and easy steps : A beginner&rsquo;s tutorial…_www.tutorialspoint.com</a><a href="https://www.tutorialspoint.com/design_pattern/singleton_pattern.htm"></a></p>
<p><a href="https://en.wikipedia.org/wiki/Singleton_pattern" title="https://en.wikipedia.org/wiki/Singleton_pattern"><strong>Singleton pattern - Wikipedia</strong><br>
_In software engineering, the singleton pattern is a software design pattern that restricts the instantiation of a class…_en.wikipedia.org</a><a href="https://en.wikipedia.org/wiki/Singleton_pattern"></a></p>
                </section>
            </article>

            

            

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://www.github.com/lyzerk">
        <i class="fa fa-github-square"></i>
    </a>
    
    <a class="symbol" href="https://www.linkedin.com/in/almozdmr/">
        <i class="fa fa-linkedin-square"></i>
    </a>
    
    <a class="symbol" href="https://medium.com/@alm.ozdmr">
        <i class="fa fa-medium"></i>
    </a>
    
    <a class="symbol" href="https://www.twitter.com/almozdmr">
        <i class="fa fa-twitter-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2020 <i class="fa fa-heart" aria-hidden="true"></i> Alim Özdemir
    
    </p>
</footer>

        </section>

        <script src="www.alimozdemir.comjs/jquery-3.3.1.min.js"></script>
<script src="www.alimozdemir.comjs/main.js"></script>
<script src="www.alimozdemir.comjs/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'your_google_analytics_id', 'auto');
	
	ga('send', 'pageview');
}
</script>





    </body>
</html>
